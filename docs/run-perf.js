import{M as e,_ as t,q as a,K as r,Z as o,R as n}from"./chunks/a1b1a69b.js";function s({percent:e,color:a}){return t("host",{shadowDom:!0},t("style",null,":host{width:100%;height:3px;position:relative;display:block}.layer{width:100%;height:100%;position:absolute;border-radius:5px}.layer.-z1{background:currentColor;opacity:.33}.dot{top:50%;right:0;position:absolute;transform:translate(50%,-50%)}"),t("div",{class:"layer -z1"}),t("div",{class:"layer -z2",style:`width:${100*e}%;background: linear-gradient(to right, ${a}50, ${a});`},t("svg",{class:"dot",height:"300%",viewBox:"0 0 100 100"},t("circle",{cx:"50",cy:"50",r:"50",fill:a}))))}function i({src:e,autorun:s}){let i=a(),[l,p]=r("state"),[c,d]=r("results");function f(){let{current:{contentDocument:t,contentWindow:a}}=i,r=e=>t=>o[e]=t,o={test:[]},n=[];if(a.before=r("before"),a.test=(e,t,a)=>n.push({name:e,test:t,before:a}),a.after=r("after"),a.ready=async()=>{d(n),p("running");let e=await(o.before&&o.before()),t=()=>new Promise(e=>a.requestIdleCallback(e));await n.reduce((a,{test:r,before:o})=>a.then(async()=>{await t();let a=o?await o():e,s=function(e,t,a){let r=performance.now(),o=0;for(;performance.now()-r<t;)o++,e(a);return o}(r,1e3,a);d(n=n.map(e=>e.test==r?{...e,operations:s}:e))}),t()),p("done"),o.after&&o.after(n)},i[e])"done"==l&&ready();else{i[e]=!0;let a=document.createElement("script");a.async=!0,a.textContent=`import("./${e}").then(ready);`,t.body.appendChild(a)}}o(()=>s&&f(),[s]),function(e,t){let{current:a}=n();a[e];a._=t,a[e]}("run",f);let u=c.map(e=>e.operations||0),m=Math.max(0,...u),h=Math.min(...u),y=m-h,b=.3*y+h,g=.6*y+h;return t("host",{shadowDom:!0},t("style",null,":host{font-family:monospace;display:block;box-sizing:border-box;position:relative}.iframe{position:absolute}.test.-header,.test.-item{padding-bottom:10px}.test.-header{display:flex}.test.-title{font-weight:700}.test.-time{margin-left:1rem;opacity:.5}.loading{width:50px;height:50px;background:#000;animation:move 1s ease infinite alternate}@keyframes move{0%{transform:translateX(0)}to{transform:translateX(100px)}}"),t("div",{class:"tests"},c.map(({name:e,operations:a=0,duration:r=0})=>t("div",{class:"test -item"},t("div",{class:"test -header"},t("div",{class:"test -title"},e),t("div",{class:"test -time"},a?a.toLocaleString("en")+" opts/s":"await...")),t("run-perf-range",{color:a>g?"#00FFD4":a>b?"#ffbe46":"#ff1a84",percent:a/m||0})))),t("iframe",{class:"iframe",ref:i,width:"0",height:"0",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation",frameborder:"0"}))}s.props={percent:{type:Number,value:50,reflect:!0},color:{type:String,value:"#000000"}},e("run-perf-range",s),i.props={src:{type:String},autorun:{type:Boolean},results:{type:Array,value:()=>[]},state:{type:String,reflect:!0,value:"",event:{type:"UpdateState"}}},e("run-perf",i);
//# sourceMappingURL=run-perf.js.map
